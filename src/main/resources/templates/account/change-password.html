<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Mudar a senha</title>
    <div th:insert="~{fragments/commons :: head}"></div>
</head>
<body>

<div class="container-form">
    <div class="user-card">
        <div class="user-header">
            <h2>Alterar senha</h2><br>
        </div>
        <form th:action="@{/account/change-password}" th:object="${passwordForm}" method="post">
            <div class="card-content">
                <div class="user-details">
                    <div class="form-group">
                        <label for="password" class="form-label">Senha</label>
                        <input type="password" class="form-control" id="password"
                               th:field="*{password}"
                               placeholder="Insira uma senha" required
                               onkeyup="validatePassword()">
                        <small>Sua senha deve conter pelo menos 8 caracteres</small>
                    </div>

                    <div class="form-group">
                        <label for="passwordConfirmation" class="form-label">Confirmar Senha</label>
                        <input type="password" class="form-control" id="passwordConfirmation"
                               th:field="*{passwordConfirmation}"
                               placeholder="Confirme sua senha" required
                               onkeyup="validatePassword()">
                        <div id="passwordMessage" class="form-text"></div>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn-confirm text-white mb-3" id="submitBtn">
                Confirmar
            </button>
        </form>

    </div>
</div>

<div th:insert="~{fragments/commons :: scripts}"></div>

<script>
    function validatePassword() {
    const password = document.getElementById('password');
    const passwordConfirmation = document.getElementById('passwordConfirmation');
    const message = document.getElementById('passwordMessage');

    password.classList.remove('is-valid', 'is-invalid');
    passwordConfirmation.classList.remove('is-valid', 'is-invalid');
    message.classList.remove('valid-feedback', 'invalid-feedback');

    if (password.value === '' || passwordConfirmation.value === '') {
        message.textContent = ' ';
        return;
    }

    if (password.value === passwordConfirmation.value) {
        password.classList.add('is-valid');
        passwordConfirmation.classList.add('is-valid');
        message.textContent = ' ✓ Senhas coincidem';
        message.classList.add('valid-feedback');
        submitBtn.disabled = false;
    } else {
        password.classList.add('is-invalid');
        passwordConfirmation.classList.add('is-invalid');
        message.textContent = ' ✗ As senhas não coincidem';
        message.classList.add('invalid-feedback');
        submitBtn.disabled = true;
    }
}
</script>
</body>

</html>