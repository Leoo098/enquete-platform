<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{fragments/commons :: head}"></div>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Enquete - Sua plataforma de enquetes</title>
</head>
<body>
<div th:replace="~{fragments/commons :: scripts}"></div>
    <div th:replace="~{fragments/commons :: header}"></div>

<section class="hero">
    <div class="container">
        <h1>Crie e participe de enquetes incríveis</h1>
        <p>Descubra o que as pessoas pensam sobre diversos temas ou crie sua própria enquete em poucos segundos.</p>
        <div class="cta-buttons">
            <a th:href="@{/poll/create}" class="btn btn-primary">Criar Enquete</a>
            <a th:href="@{/polls/my-polls}" class="btn" style="background: white; color: var(--primary-color);">Ver Enquetes</a>
        </div>
    </div>
</section>

<section class="features">
    <div class="container">
        <div class="section-title">
            <h2>Por que usar o Enquete?</h2>
            <p>Nossa plataforma oferece tudo que você precisa para criar e compartilhar enquetes de forma simples e eficiente.</p>
        </div>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <h3>Rápido e Fácil</h3>
                <p>Crie enquetes em menos de um minuto com nosso editor intuitivo.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <h3>Resultados e Histórico de Enquetes votadas</h3>
                <p>Acompanhe os votos das suas enquetes e enquetes que você participou.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-share-alt"></i>
                </div>
                <h3>Compartilhamento Fácil</h3>
                <p>Compartilhe suas enquetes entre amigos.</p>
            </div>
        </div>
    </div>
</section>

<section class="trending-polls">
    <div class="container">
        <div class="section-title">
            <h2>Enquetes em Destaque</h2>
            <p>Veja algumas das enquetes abertas da nossa comunidade.</p>
        </div>
        <div th:unless="${polls.empty}" class="horizontal-scroll-wrapper">
            <button class="scroll-btn scroll-btn-left" onclick="scrollToLeft()">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="horizontal-scroll-container" id="scrollContainer">
                <div class="horizontal-scroll">
                    <div th:each="poll : ${polls}" class="card" th:attr="data-poll-id=${poll.id}"  onclick="redirectToPoll(this)">
                        <div class="card-header">
                            <h2 class="card-title" th:text="${poll.question}"></h2>
                        </div>
                        <div class="card-content overflow-y-auto">
                            <div class="options">
                                <div th:each="option : ${poll.options}" class="option">
                                    <div>
                                        <strong th:text="${option.text}" class=""></strong>
                                        <span>
                                            <small class="votes"
                                                   th:text="|(${option.votes} ${option.votes == 1 ? 'voto' : 'votos'})|">
                                            </small>
                                        </span>
                                    </div>
                                    <div class="progress">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated custom-color-bar"
                                             role="progressbar"
                                             th:aria-valuenow="${option.percentage}"
                                             aria-valuemin="0"
                                             aria-valuemax="100"
                                             th:style="'width: ' + ${option.percentage} + '%;'">
                                            <span class="bar-text" th:text="${#numbers.formatDecimal(option.percentage, 1, 1)} + '%'"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="poll-stats">
                                <span>
                                    <i class="fas fa-chart-bar"></i>
                                    <span th:text="|${poll.totalVotes} ${poll.totalVotes == 1 ? ' voto' : ' votos'}|"></span>
                                </span>
                                <span th:unless="${poll.expired}"
                                      class="badge bg-success bg-timer poll-timer"
                                      th:data-expires-at="${poll.expiresAt.toEpochMilli()}">
                                    <span th:text="${poll.timeLeft}"></span>
                                </span>
                            </div>
                            <div class="card-footer" style="margin-top: 10px;">
                                <div class="footer-stats">
                                    <span>
                                        <i class="far fa-user"></i>
                                        <span th:text="${poll.createdBy}"></span>
                                    </span>
                                        <span><i class="far fa-calendar"></i>
                                        <span th:text="${#temporals.format(poll.createdAt, 'dd/MM/yyyy')}"></span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="scroll-btn scroll-btn-right" onclick="scrollToRight()">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

</section>
    <div th:replace="~{fragments/timer-script :: timer-script}"></div>

    <script>
        function redirectToPoll(element){
            const pollId = element.getAttribute('data-poll-id');
            window.location = '/poll/' + pollId;
        }

        function scrollToLeft() {
            const container = document.getElementById('scrollContainer');
            container.scrollBy({ left: -1200, behavior: 'smooth' });
        }

        function scrollToRight() {
            const container = document.getElementById('scrollContainer');
            container.scrollBy({ left: 1200, behavior: 'smooth' });
        }
    </script>
</body>

<footer>
    <div class="container">
    </div>
</footer>
</html>